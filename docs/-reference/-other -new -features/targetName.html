<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>The @targetName annotation</title><script type="text/javascript" src="../../../scripts/clipboard.js" defer="true"></script><script type="text/javascript" src="../../../scripts/platform-content-handler.js" defer="true"></script><script type="text/javascript" src="../../../scripts/main.js" defer="true"></script><link rel="stylesheet" href="../../../styles/nord-light.css"></link><link rel="stylesheet" href="../../../styles/scalastyle.css"></link><link rel="stylesheet" href="../../../styles/dotty-icons.css"></link><link rel="stylesheet" href="../../../styles/diagram.css"></link><link rel="stylesheet" href="../../../styles/filter-bar.css"></link><link rel="stylesheet" href="../../../styles/search-bar.css"></link><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="../../../scripts/diagram.js" defer="true"></script><link rel="stylesheet" href="../../../styles/filter-bar.css"></link><script type="text/javascript" src="../../../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../../../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../../../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../../../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../../../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../../../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../../../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../../../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../../../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../../../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../../../scripts/data.js" defer="true"></script><script type="text/javascript" src="../../../scripts/fast-navigation-loader.js" defer="true"></script><link rel="stylesheet" href="../../../css/bootstrap.min.css"></link><link rel="stylesheet" href="../../../css/dottydoc.css"></link><link rel="stylesheet" href="../../../css/color-brewer.css"></link><script type="text/javascript" src="../../../js/jquery.min.js" defer="true"></script><script type="text/javascript" src="../../../js/bootstrap.min.js" defer="true"></script><script>var pathToRoot = "../../../";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"></div><div id="paneSearch"></div><nav id="sideMenu"></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="searchBar"></div><main>
  <div id="content" pageIds="_.docs/reference/other-new-features/targetName.md////PointingToDeclaration//-1025483213">
    <div class="breadcrumbs"><a href="../../index.html"></a>/<a href="../../Reference/index.html">Reference</a>/<a href="index.html">Other New Features</a>/<a href="../-other -new -features/targetName.html">The @targetName annotation</a></div>
<html>
 <head>
  <link rel="dns-prefetch" href="//fonts.googleapis.com"> 
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"> 
 </head>
 <body>
  <div id="content-wrapper"> 
   <main class="container"> 
    <header> 
     <h1>The @targetName annotation</h1> 
     <div class="byline"> <a href="/edit/master//"> <i class="far fa-edit"></i> Edit this page on GitHub </a> 
     </div> 
    </header> 
    <p>A <code>@targetName</code> annotation on a definition defines an alternate name for the implementation of that definition. Example:</p> 
    <pre><code class="language-scala">import scala.annotation.targetName

object VecOps {
  @targetName("append") def (xs: Vec[T]) ++= [T] (ys: Vec[T]): Vec[T] = ...
}
</code></pre> 
    <p>Here, the <code>++=</code> operation is implemented (in Byte code or native code) under the name <code>append</code>. The implementation name affects the code that is generated, and is the name under which code from other languages can call the method. For instance, <code>++=</code> could be invoked from Java like this:</p> 
    <pre><code>VecOps.append(vec1, vec2)
</code></pre> 
    <p>The <code>@targetName</code> annotation has no bearing on Scala usages. Any application of that method in Scala has to use <code>++=</code>, not <code>append</code>.</p> 
    <h3>Details</h3> 
    <ol> 
     <li> <p><code>@targetName</code> is defined in package <code>scala.annotation</code>. It takes a single argument of type <code>String</code>. That string is called the <em>external name</em> of the definition that's annotated.</p> </li> 
     <li> <p>A <code>@targetName</code> annotation can be given for all kinds of definitions.</p> </li> 
     <li> <p>The name given in a <code>@targetName</code> annotation must be a legal name for the defined entities on the host platform.</p> </li> 
     <li> <p>It is recommended that definitions with symbolic names have a <code>@targetName</code> annotation. This will establish an alternate name that is easier to search for and will avoid cryptic encodings in runtime diagnostics.</p> </li> 
     <li> <p>Definitions with names in backticks that are not legal host platform names should also have a <code>@targetName</code> annotation.</p> </li> 
    </ol> 
    <h3>Relationship with Overriding</h3> 
    <p><code>@targetName</code> annotations are significant for matching two method definitions to decide whether they conflict or override each other. Two method definitions match if they have the same name, signature, and erased name. Here,</p> 
    <ul> 
     <li>The <em>signature</em> of a definition consists of the names of the erased types of all (value-) parameters and the method's result type.</li> 
     <li>The <em>erased name</em> of a method definition is its target name if a <code>@targetName</code> annotation is given and its defined name otherwise.</li> 
    </ul> 
    <p>This means that <code>@targetName</code> annotations can be used to disambiguate two method definitions that would otherwise clash. For instance.</p> 
    <pre><code class="language-scala">def f(x: =&gt; String): Int = x.length
def f(x: =&gt; Int): Int = x + 1  // error: double definition
</code></pre> 
    <p>The two definitions above clash since their erased parameter types are both <code>Function0</code>, which is the type of the translation of a by-name-parameter. Hence they have the same names and signatures. But we can avoid the clash by adding a <code>@targetName</code> annotation to either method or to both of them. E.g.</p> 
    <pre><code class="language-scala">@targetName("f_string")
def f(x: =&gt; String): Int = x.length
def f(x: =&gt; Int): Int = x + 1  // OK
</code></pre> 
    <p>This will produce methods <code>f_string</code> and <code>f</code> in the generated code.</p> 
    <p>However, <code>@targetName</code> annotations are not allowed to break overriding relationships between two definitions that have otherwise the same names and types. So the following would be in error:</p> 
    <pre><code class="language-scala">import annotation.targetName
class A:
  def f(): Int = 1
class B extends A:
  targetName("g") def f(): Int = 2
</code></pre> 
    <p>The compiler reports here:</p> 
    <pre><code>-- Error: test.scala:6:23 ------------------------------------------------------
6 |  @targetName("g") def f(): Int = 2
  |                       ^
  |error overriding method f in class A of type (): Int;
  |  method f of type (): Int should not have a @targetName annotation since the overridden member hasn't one either
</code></pre> 
    <p>The relevant overriding rules can be summarized as follows:</p> 
    <ul> 
     <li>Two members can override each other if their names and signatures are the same, and they either have the same erased names or the same types.</li> 
     <li>If two members override, then both their erased names and their types must be the same.</li> 
    </ul> 
    <p>As usual, any overriding relationship in the generated code must also be present in the original code. So the following example would also be in error:</p> 
    <pre><code class="language-scala">import annotation.targetName
class A:
  def f(): Int = 1
class B extends A:
  targetName("f") def g(): Int = 2
</code></pre> 
    <p>Here, the original methods <code>g</code> and <code>f</code> do not override each other since they have different names. But once we switch to target names, there is a clash that is reported by the compiler:</p> 
    <pre><code>-- [E120] Naming Error: test.scala:4:6 -----------------------------------------
4 |class B extends A:
  |      ^
  |      Name clash between defined and inherited member:
  |      def f(): Int in class A at line 3 and
  |      def g(): Int in class B at line 5
  |      have the same name and type after erasure.
1 error found
</code></pre> 
   </main> 
  </div> 
  <script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'lampepfl/dotty'
  };
</script> 
  <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
 </body>
</html>  </div>
</main><footer><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span>&nbsp;Back to top</a></span><span class="pull-right">Generated by&nbsp;<a href="https://github.com/lampepfl/scala3doc">Scala3doc</a></span></footer></div></div><script type="text/javascript" src="../../../scripts/pages.js"></script><script type="text/javascript" src="../../../scripts/main.js"></script></body></html>
